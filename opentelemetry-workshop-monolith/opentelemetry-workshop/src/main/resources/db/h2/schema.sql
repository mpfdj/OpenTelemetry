DROP TABLE PROJECT_SKILL IF EXISTS;
DROP TABLE DEVELOEPR_SKILL IF EXISTS;
DROP TABLE PROJECT IF EXISTS;
DROP TABLE SKILL IF EXISTS;
DROP TABLE JOB IF EXISTS;
DROP TABLE DEVELOPER IF EXISTS;
DROP TABLE COMPANY IF EXISTS;

CREATE TABLE PROJECT (
  id    INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name  VARCHAR(30)
);
CREATE INDEX project_name ON PROJECT (name);

CREATE TABLE SKILL (
  id   INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name VARCHAR(80)
);
CREATE INDEX SKILL_name ON SKILL (name);

CREATE TABLE PROJECT_SKILLS (
  project_id    INTEGER NOT NULL,
  skill_id      INTEGER NOT NULL
);
ALTER TABLE PROJECT_SKILLS ADD CONSTRAINT fk_project_skill_project FOREIGN KEY (project_id) REFERENCES PROJECT (id);
ALTER TABLE PROJECT_SKILLS ADD CONSTRAINT fk_project_skill_Skill FOREIGN KEY (skill_id) REFERENCES SKILL (id);

CREATE TABLE COMPANY (
  id         INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name       VARCHAR(30),
  address    VARCHAR(255),
  city       VARCHAR(80),
  telephone  VARCHAR(20)
);
CREATE INDEX company_name ON COMPANY (name);

CREATE TABLE DEVELOPER (
  id         INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  firstName  VARCHAR(30),
  lastName   VARCHAR(30),
  company_id INTEGER
);
ALTER TABLE DEVELOPER ADD CONSTRAINT fk_developer_company FOREIGN KEY (company_id) REFERENCES COMPANY (id);
CREATE INDEX developer_lastname ON DEVELOPER (lastName);

CREATE TABLE DEVELOPER_SKILLS (
    developer_id    INTEGER NOT NULL,
    skill_id      INTEGER NOT NULL
);
ALTER TABLE DEVELOPER_SKILLS ADD CONSTRAINT fk_developer_skill_developer FOREIGN KEY (developer_id) REFERENCES DEVELOPER (id);
ALTER TABLE DEVELOPER_SKILLS ADD CONSTRAINT fk_developer_skill_Skill FOREIGN KEY (skill_id) REFERENCES SKILL (id);

CREATE TABLE JOB (
  id           INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  developer_id INTEGER,
  project_id   INTEGER,
  start_date   DATE,
  description  VARCHAR(255)
);
ALTER TABLE JOB ADD CONSTRAINT fk_job_develoepr FOREIGN KEY (developer_id) REFERENCES DEVELOPER (id);
ALTER TABLE JOB ADD CONSTRAINT fk_job_project FOREIGN KEY (project_id) REFERENCES PROJECT (id);

